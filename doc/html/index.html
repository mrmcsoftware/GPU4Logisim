<html>
<head>
<title>Welcome to Logisim!</title>
<style>
table
	{
	display: table;
	border-collapse: separate;
	border-spacing: 2px;
	border-color: grey;
	text-shadow: 3px 3px 2px #000000;
	}
span.b3
	{
	background-color: #ff0000;
	color: #ffffff;
	}
span.b2
	{
	background-color: #ff7f00;
	color: #000000;
	}
span.b1
	{
	background-color: #ffff00;
	color: #000000;
	}
span.b0
	{
	background-color: #7fff00;
	color: #000000;
	}
span.w1
	{
	background-color: #00ffff;
	color: #000000;
	}
span.w0
	{
	background-color: #0044ff;
	color: #ffffff;
	}
</style>
</head>

<body bgcolor="#000000" color="#ffffff" style='margin: 10px;'>
<font color="#ffffff">

<h1>Welcome to GPU Help!</h1>

This GPU video screen is a drop-in replacement for the existing LCD Video screens.  It
will do the normal LCD screen operations that you might be familiar with.  But, if you
set the GPU Select line to 1, 2, or 3, it will do extra GPU functions.<br><br>
The GPUs RAM and ROM can be loaded by clicking the right mouse button on the GPU
component and selecting the desired Load function on the menu.  Then choose the
desired image file.  Currently, an image file's first line must be the common Logisim
image file header of "<b>v2.0 raw</b>".  The data that would follow must be in hexadecimal.
Comments can be put in by starting the comment with a "<b>#</b>"<br><br>
<img src="gpucomp.png">

<h3>GPU Select Line</h3>
To write a value to the GPU's RAM, first set the GPU memory address (with GPU Select 1) -
the memory address being on the GPU Data In line.
Then write the desired value (being on the GPU Data In line) to the previously specified
memory address (with GPU Select 2).  To do a GPU function (using GPU Select 3) <b>that
requires the use of the GPU's RAM or ROM (ones not highlighted in green in the GPU
Functions table)</b>, set the GPU memory address (with GPU Select 1) and then do the GPU
function using GPU Select 3 (value on the GPU Data In line).
By the way, a memory address that is set will be remembered
after subsequent operations, so no need to keep setting it if it doesn't need to be changed.
If the GPU function doesn't require the GPU's RAM or ROM, no need to set an address.
Currently, the GPU's RAM and ROM have a limit of 1048576 (100000 hex) 32-bit elements each.
Even though there is this limit, any address below 800000 hex is considered RAM space and
any address at or above 800000 hex is considered ROM space.  The GPU Data Out line will
always (and only) show the value of the RAM or ROM at the specified memory address.  By
the way, currently the GPU portion of the video screen in its default configuration doesn't require the Clock line to operate.  However, it is likely
that your design will effectively trigger a GPU operation on a clock cycle anyway.  You
can set the trigger type if you want, however.
<br><br>
<TABLE BORDER=2 bgcolor="#102054" STYLE='color: #ffffff' VALIGN=center CELLPADDING=4>
<TR>
<TH ALIGN=center STYLE='background-color: #00109f'><b>&nbsp;GPU Select&nbsp;</b></TD>
<TH ALIGN=center STYLE='background-color: #00109f'><b>&nbsp;Function</b></TD>
</TR>
<TR>
<TD ALIGN=center><b>0</b></TD>
<TD ALIGN=left><b>&nbsp;GPU not used - Behave like normal Video screen.</b></TD>
</TR>
<TR>
<TD ALIGN=center><b>1</b></TD>
<TD ALIGN=left><b>&nbsp;Set GPU memory address.</b></TD>
</TR>
<TR>
<TD ALIGN=center><b>2</b></TD>
<TD ALIGN=left><b>&nbsp;Write value to GPU memory.</b></TD>
</TR>
<TR>
<TD ALIGN=center><b>3</b></TD>
<TD ALIGN=left><b>&nbsp;Do GPU function.</b></TD>
</TR>
</TABLE>

<h3>Alternate Way to Set GPU Address</h3>
Instead of using the GPU Select Line (value 1) to set the GPU memory address, you could
use the GPU Address pin on the GPU.  If the value on the pin isn't floating or error at
the time a GPU function is performed, the address will be whatever is on this pin at
the time.  If the value is floating (perhaps not connected to anything) or an error,
the address will be whatever the previous good address was (perhaps set by the
GPU Select Line).

<h3>GPU Functions</h3>
Functions highlighted in green don't need any data in the GPU's RAM or ROM.  00 means
the value doesn't matter, but there should be 2 hex characters in that place so the
function code (Byte1) will be in the right bit positions.  Byte1, Byte2, Byte3, and
Byte4 together make up a 32 bit value with Byte1 being the most significant.
For functions <b>3</b> and <b>4</b>, "Move to" specifies the start of a line segment
and "Line to" specifies the end point and draws it.  Any subsequent "Line to" will use
the last specified point as the start of a new line segment.
For text. there currently are 3 fonts defined (Arial Bold 12, Courier New 12, and Tahoma 11)
and up to 16 user-definable fonts.  The 3 defined fonts may depend on your system.
The user-definable fonts can be created by using function <b>20</b>.
For Text function <b>8</b>, the font number needs to
be specified.  It can be <b>0</b>, <b>1</b>, or <b>2</b> for the pre-defined fonts, or
<b>4</b> through <b>19</b> (decimal) for the user-defined fonts.  The Text Char function <b>9</b> uses Courier New 12.
Function <b>1f</b> can be used to define a linear color gradient.  Once specified, it applies
to most drawing functions until it is turned off by setting the <b>On</b> value to <b>0</b>.
It not only applies to filled objects (which would be expected), but it also
applies to text and lines, for example.
For function <b>14</b>, the values specified are indexes into a point storage section
of the GPU's memory.  The start address of a point storage section is specified by
using the GPU Select Line 1 function (Set GPU memory address).
For function <b>19</b>, <b>SolidDotDash</b> is the stroke type: <b>00</b> for solid lines, 
<b>01</b> for dotted lines, and <b>02</b> for dashed lines.  <b>Width</b> is the line width.
Function <b>1c</b> can be used to produce a "rubber band" effect, which is the use of
exclusive OR (XOR) drawing mode to draw an object and then erase it by drawing it again.
You most likely have seen this effect in paint programs, for example, when you draw
a line setting one point and dragging the line to the desired endpoint.
The Set pixel function (<b>11</b>) sets the specified pixel to the current GPU color.
For functions <b>b</b> and <b>d</b>, if the Image # or Sprite # respectively is greater
than 0, use already created blit or sprite respectively.
Currently there is a limit of 17 blit images (One on the fly
blit (#0) and 16 pre-created blit images (#1-#16)).  And a limit of 17 sprite images (One
on the fly sprite (#0) and 16 pre-created sprite images (#1-#16)).  You can turn off an
individual sprite by setting both it's X position and Y position to 255 (ff).
In general, due to the fact that positions are 1 byte, there can never be negative
positions.  Since this can be a problem for blits and sprites, there is a workaround -
the positional alignment can be changed.  By using functions <b>1d</b> and <b>1e</b>,
the x and y alignment can be set: <b>00</b> for the default alignment which is top and/or left,
<b>01</b> for bottom and/or right, and <b>02</b> for center.
Also, because of the previously mentioned 1 byte limitation, there can only be a maximum of a 256x256
pixel video screen.  That's why other resolutions aren't supported.  Similarly, blit and
sprite images can't be any bigger than 256 pixels width and 256 pixels height.
There are I believe
versions of Logisim Evolution that support 64 bits, which would then allow more bits for
the data, but I figure it will take some time for people to start making 64-bit CPUs, etc.
So for now, these limitations stand.
<br><br>
<TABLE BORDER=2 bgcolor="#102054" STYLE='color: #ffffff' VALIGN=center CELLPADDING=4>
<TR>
<TH ALIGN=center STYLE='background-color: #00109f'><b>&nbsp;Function&nbsp;</b></TD>
<TH ALIGN=center STYLE='background-color: #00109f'><b>&nbsp;Byte1&nbsp;</b></TD>
<TH ALIGN=center STYLE='background-color: #00109f'><b>&nbsp;Byte2&nbsp;</b></TD>
<TH ALIGN=center STYLE='background-color: #00109f'><b>&nbsp;Byte3&nbsp;</b></TD>
<TH ALIGN=center STYLE='background-color: #00109f'><b>&nbsp;Byte4&nbsp;</b></TD>
</TR>
<TR STYLE='background-color: #208028'>
<TD ALIGN=left><b>&nbsp;Clear screen with specified color</b></TD>
<TD ALIGN=center><b>0</b></TD>
<TD ALIGN=center><b>Red</b></TD>
<TD ALIGN=center><b>Green</b></TD>
<TD ALIGN=center><b>Blue</b></TD>
</TR>
<TR STYLE='background-color: #208028'>
<TD ALIGN=left><b>&nbsp;Set current color</b></TD>
<TD ALIGN=center><b>1</b></TD>
<TD ALIGN=center><b>Red</b></TD>
<TD ALIGN=center><b>Green</b></TD>
<TD ALIGN=center><b>Blue</b></TD>
</TR>
<TR>
<TD ALIGN=left><b>&nbsp;Line</b></TD>
<TD ALIGN=center><b>2</b></TD>
<TD ALIGN=center><b>00</b></TD>
<TD ALIGN=center><b>X Pos</b></TD>
<TD ALIGN=center><b>Y Pos</b></TD>
</TR>
<TR STYLE='background-color: #208028'>
<TD ALIGN=left><b>&nbsp;Move to</b></TD>
<TD ALIGN=center><b>3</b></TD>
<TD ALIGN=center><b>00</b></TD>
<TD ALIGN=center><b>X Pos</b></TD>
<TD ALIGN=center><b>Y Pos</b></TD>
</TR>
<TR STYLE='background-color: #208028'>
<TD ALIGN=left><b>&nbsp;Line to</b></TD>
<TD ALIGN=center><b>4</b></TD>
<TD ALIGN=center><b>00</b></TD>
<TD ALIGN=center><b>X Pos</b></TD>
<TD ALIGN=center><b>Y Pos</b></TD>
</TR>
<TR>
<TD ALIGN=left><b>&nbsp;Polyline</b></TD>
<TD ALIGN=center><b>5</b></TD>
<TD ALIGN=center><b>00</b></TD>
<TD ALIGN=center><b>X Pos</b></TD>
<TD ALIGN=center><b>Y Pos</b></TD>
</TR>
<TR>
<TD ALIGN=left><b>&nbsp;Polygon (closed)</b></TD>
<TD ALIGN=center><b>6</b></TD>
<TD ALIGN=center><b>00</b></TD>
<TD ALIGN=center><b>X Pos</b></TD>
<TD ALIGN=center><b>Y Pos</b></TD>
</TR>
<TR>
<TD ALIGN=left><b>&nbsp;Filled polygon</b></TD>
<TD ALIGN=center><b>7</b></TD>
<TD ALIGN=center><b>00</b></TD>
<TD ALIGN=center><b>X Pos</b></TD>
<TD ALIGN=center><b>Y Pos</b></TD>
</TR>
<TR>
<TD ALIGN=left><b>&nbsp;Text</b></TD>
<TD ALIGN=center><b>8</b></TD>
<TD ALIGN=center><b>Font #</b></TD>
<TD ALIGN=center><b>X Pos</b></TD>
<TD ALIGN=center><b>Y Pos</b></TD>
</TR>
<TR STYLE='background-color: #208028'>
<TD ALIGN=left><b>&nbsp;Text Char.</b></TD>
<TD ALIGN=center><b>9</b></TD>
<TD ALIGN=center><b>ASCII #</b></TD>
<TD ALIGN=center><b>X Pos</b></TD>
<TD ALIGN=center><b>Y Pos</b></TD>
</TR>
<TR>
<TD ALIGN=left><b>&nbsp;Create blit src</b></TD>
<TD ALIGN=center><b>a</b></TD>
<TD ALIGN=center><b>00</b></TD>
<TD ALIGN=center><b>00</b></TD>
<TD ALIGN=center><b>Image #</b></TD>
</TR>
<TR>
<TD ALIGN=left><b>&nbsp;Blit</b></TD>
<TD ALIGN=center><b>b</b></TD>
<TD ALIGN=center><b>Image #</b></TD>
<TD ALIGN=center><b>X Pos</b></TD>
<TD ALIGN=center><b>Y Pos</b></TD>
</TR>
<TR>
<TD ALIGN=left><b>&nbsp;Create sprite src</b></TD>
<TD ALIGN=center><b>c</b></TD>
<TD ALIGN=center><b>00</b></TD>
<TD ALIGN=center><b>00</b></TD>
<TD ALIGN=center><b>Sprite #</b></TD>
</TR>
<TR>
<TD ALIGN=left><b>&nbsp;Sprite</b></TD>
<TD ALIGN=center><b>d</b></TD>
<TD ALIGN=center><b>Sprite #</b></TD>
<TD ALIGN=center><b>X Pos</b></TD>
<TD ALIGN=center><b>Y Pos</b></TD>
</TR>
<TR STYLE='background-color: #208028'>
<TD ALIGN=left><b>&nbsp;Sprites on/off</b></TD>
<TD ALIGN=center><b>e</b></TD>
<TD ALIGN=center><b>00</b></TD>
<TD ALIGN=center><b>00</b></TD>
<TD ALIGN=center><b>On Flag</b></TD>
</TR>
<TR>
<TD ALIGN=left><b>&nbsp;Oval / Circle</b></TD>
<TD ALIGN=center><b>f</b></TD>
<TD ALIGN=center><b>00</b></TD>
<TD ALIGN=center><b>X Pos</b></TD>
<TD ALIGN=center><b>Y Pos</b></TD>
</TR>
<TR>
<TD ALIGN=left><b>&nbsp;Filled Oval / Circle</b></TD>
<TD ALIGN=center><b>10</b></TD>
<TD ALIGN=center><b>00</b></TD>
<TD ALIGN=center><b>X Pos</b></TD>
<TD ALIGN=center><b>Y Pos</b></TD>
</TR>
<TR STYLE='background-color: #208028'>
<TD ALIGN=left><b>&nbsp;Set pixel</b></TD>
<TD ALIGN=center><b>11</b></TD>
<TD ALIGN=center><b>00</b></TD>
<TD ALIGN=center><b>X Pos</b></TD>
<TD ALIGN=center><b>Y Pos</b></TD>
</TR>
<TR>
<TD ALIGN=left><b>&nbsp;Run GPU program</b></TD>
<TD ALIGN=center><b>12</b></TD>
<TD ALIGN=center><b>Address (Byte1)</TD>
<TD ALIGN=center><b>Address (Byte2)</b></TD>
<TD ALIGN=center><b>Address (Byte3)</b></TD>
</TR>
<TR>
<TD ALIGN=left><b>&nbsp;End GPU program</b></TD>
<TD ALIGN=center><b>13</b></TD>
<TD ALIGN=center><b>00</b></TD>
<TD ALIGN=center><b>00</b></TD>
<TD ALIGN=center><b>00</b></TD>
</TR>
<TR>
<TD ALIGN=left><b>&nbsp;LineV</b></TD>
<TD ALIGN=center><b>14</b></TD>
<TD ALIGN=center><b>00</TD>
<TD ALIGN=center><b>Pstart</b></TD>
<TD ALIGN=center><b>Pend</b></TD>
</TR>
<TR>
<TD ALIGN=left><b>&nbsp;Arc</b></TD>
<TD ALIGN=center><b>15</b></TD>
<TD ALIGN=center><b>00</TD>
<TD ALIGN=center><b>X Pos</b></TD>
<TD ALIGN=center><b>Y Pos</b></TD>
</TR>
<TR>
<TD ALIGN=left><b>&nbsp;Filled Arc</b></TD>
<TD ALIGN=center><b>16</b></TD>
<TD ALIGN=center><b>00</TD>
<TD ALIGN=center><b>X Pos</b></TD>
<TD ALIGN=center><b>Y Pos</b></TD>
</TR>
<TR>
<TD ALIGN=left><b>&nbsp;Rounded Rectangle</b></TD>
<TD ALIGN=center><b>17</b></TD>
<TD ALIGN=center><b>00</TD>
<TD ALIGN=center><b>X Pos</b></TD>
<TD ALIGN=center><b>Y Pos</b></TD>
</TR>
<TR>
<TD ALIGN=left><b>&nbsp;Filled Rounded Rectangle</b></TD>
<TD ALIGN=center><b>18</b></TD>
<TD ALIGN=center><b>00</TD>
<TD ALIGN=center><b>X Pos</b></TD>
<TD ALIGN=center><b>Y Pos</b></TD>
</TR>
<TR STYLE='background-color: #208028'>
<TD ALIGN=left><b>&nbsp;Set stroke type</b></TD>
<TD ALIGN=center><b>19</b></TD>
<TD ALIGN=center><b>00</b></TD>
<TD ALIGN=center><b>SolidDotDash</b></TD>
<TD ALIGN=center><b>Width</b></TD>
</TR>
<TR STYLE='background-color: #208028'>
<TD ALIGN=left><b>&nbsp;Start double buffer</b></TD>
<TD ALIGN=center><b>1a</b></TD>
<TD ALIGN=center><b>00</b></TD>
<TD ALIGN=center><b>00</b></TD>
<TD ALIGN=center><b>00</b></TD>
</TR>
<TR STYLE='background-color: #208028'>
<TD ALIGN=left><b>&nbsp;End double buffer</b></TD>
<TD ALIGN=center><b>1b</b></TD>
<TD ALIGN=center><b>00</b></TD>
<TD ALIGN=center><b>00</b></TD>
<TD ALIGN=center><b>00</b></TD>
</TR>
<TR STYLE='background-color: #208028'>
<TD ALIGN=left><b>&nbsp;Set XOR mode for drawing</b></TD>
<TD ALIGN=center><b>1c</b></TD>
<TD ALIGN=center><b>Red</b></TD>
<TD ALIGN=center><b>Green</b></TD>
<TD ALIGN=center><b>Blue</b></TD>
</TR>
<TR STYLE='background-color: #208028'>
<TD ALIGN=left><b>&nbsp;Set blit alignment</b></TD>
<TD ALIGN=center><b>1d</b></TD>
<TD ALIGN=center><b>Image #</b></TD>
<TD ALIGN=center><b>Xalign</b></TD>
<TD ALIGN=center><b>Yalign</b></TD>
</TR>
<TR STYLE='background-color: #208028'>
<TD ALIGN=left><b>&nbsp;Set sprite alignment</b></TD>
<TD ALIGN=center><b>1e</b></TD>
<TD ALIGN=center><b>Sprite #</b></TD>
<TD ALIGN=center><b>Xalign</b></TD>
<TD ALIGN=center><b>Yalign</b></TD>
</TR>
<TR>
<TD ALIGN=left><b>&nbsp;Gradient paint</b></TD>
<TD ALIGN=center><b>1f</b></TD>
<TD ALIGN=center><b>00</TD>
<TD ALIGN=center><b>00</b></TD>
<TD ALIGN=center><b>On</b></TD>
</TR>
<TR>
<TD ALIGN=left><b>&nbsp;Create user font</b></TD>
<TD ALIGN=center><b>20</b></TD>
<TD ALIGN=center><b>00</TD>
<TD ALIGN=center><b>00</b></TD>
<TD ALIGN=center><b>Userfont #</b></TD>
</TR>
<TR STYLE='background-color: #208028'>
<TD ALIGN=left><b>&nbsp;GPU Reset</b></TD>
<TD ALIGN=center><b>ff</b></TD>
<TD ALIGN=center><b>00</b></TD>
<TD ALIGN=center><b>00</b></TD>
<TD ALIGN=center><b>00</b></TD>
</TR>
</TABLE>
<h3>Data Formats in GPU Memory</h3>
Each line definition is stored as a 32-bit value in memory:<br>
<img src="XsYsXeYe.png">
<br><br>
Each polyline/polygon definition is stored as a 32-bit value in memory specifying
the number of points followed by that many 16-bit values (the most significant
16 bits of the 32-bit number are ignored):<br>
<img src="XY.png">
<br><br>
Each text string consists of a set of 8-bit values (the most significant 24 bits
of each 32-bit number are ignored) which is terminated by a 0.  Currently, a
string will automatically terminate after 256 characters to avoid an infinite loop
in case you forget the 0 terminator.
<br><br>
Each user-definable font consists of a 16-bit value (the most significant 16 bits
of the 32-bit number are ignored) in memory specifying the font style and font size:<br>
<img src="StyleSize.png"><br>
followed by the font name which is a string consisting of 8-bit values (the most
significant 24 bits of each 32-bit number are ignored) which is terminated by a 0.
The style can be <b>0</b> for plain, <b>1</b> for bold, <b>2</b> for italic, or
<b>3</b> for bold-italic.
<br><br>
Each oval/circle is stored as a 32-bit value in memory:<br>
<img src="XrYrXpYp.png">
<br><br>
Each gradient paint is stored as 4 32-bit values in memory.  A gradient paint
is done by specifying the color at a certain starting point and the color at a
certain ending point.  Those points are stored in the first of the 4 values:<br>
<img src="XsYsXeYe.png"><br>
The next 2 values of the set of 4 are the starting color and the ending color respectively.
They are of the form:<br>
<img src="ARGB.png"><br>
If the alpha part is 0, that color is fully transparent.  If the alpha part is 255 (ff), that color is fully opaque.
The last value of the set of 4 is an 8-bit value (the most significant 24 bits are ignored) which is the cyclic flag
(a value of <b>0</b> means the gradient is acyclic, a value of <b>1</b> means the gradient is cyclic).  An acyclic gradient
means that areas outside of the range from the starting point to the ending point are clamped to the color of the nearest specified point.
A cyclic gradient continues to cycle the gradient colors beyond the range from the starting point to the ending point.
<br><br>
Each blit and sprite image is stored as a 16-bit value (the most significant 16 bits
of the 32-bit number are ignored) containing the resolution:<br>
<img src="WH.png"><br>
followed by the image data consisting of <b>Width</b> times <b>Height</b> 32-bit values (no
padding needed for non-power-of-2 widths).  The values of width and height should be one less than the actual width and height since a typical resolution
could be 256 and 256 can't be stored in one byte.
In the case of blits, the most significant
8 bits of a pixel element in the image data are ignored:<br>
<img src="RGB.png"><br>
In the case of sprites, all 32 bits of a pixel element are used:<br>
<img src="ARGB.png"><br>
If the alpha part of the pixel is 0, that pixel is fully transparent.  If the alpha
part is 255 (ff), that pixel is fully opaque (fully shown).
<br><br>
Each GPU program is stored as a collection of pairs of 32-bit values.  The first of
the pair is the GPU Select value, and the last of the pair is the GPU Data In value.
The program is terminated by an End GPU program function (<b>13 hex</b>).  By the
way, a GPU program can call a GPU program, and so on (as long as the stack size
limit isn't reached).  In general, be careful when computing the addresses of each
GPU program - it can be confusing having to think in terms of each GPU operation
being two 32-bit values.
<br><br>
Point data for the LineV function is stored as a consecutive list of 16-bit values (the
most significant 16 bits of the 32-bit number are ignored):<br>
<img src="XY.png"><br>
Unlike the polygon function, the number of points is not part of this storage.
<br><br>
Each Arc is stored as a 32-bit value in memory:<br>
<img src="XrYrXpYp.png"><br>
followed by another 32-bit value (all 32 bits are used - both are 16-bit values.  Might need to be careful about your CPU's Endianness if different than x86):<br>
<img src="AsAe.png">
<br><br>
Each Rounded Rectangle is stored as a 32-bit value in memory:<br>
<img src="WHAwAh.png">
<h3>Author</h3>
Mark Craig<br>
https://www.youtube.com/MrMcSoftware<br>
https://github.com/mrmcsoftware
</font>
</body>
</html>
